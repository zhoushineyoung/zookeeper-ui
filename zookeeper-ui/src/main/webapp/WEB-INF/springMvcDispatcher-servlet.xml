<?xml version="1.0" encoding="UTF-8"?>
<beans 
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:webflow="http://www.springframework.org/schema/webflow-config"
    xmlns:faces="http://www.springframework.org/schema/faces"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
        http://www.springframework.org/schema/webflow-config http://www.springframework.org/schema/webflow-config/spring-webflow-config-2.3.xsd
        http://www.springframework.org/schema/faces http://www.springframework.org/schema/faces/spring-faces-2.2.xsd
    ">
    
    <!-- Configures a handler that uses the JSF ResourceHandler API introduced in JSF 2 to serve web 
         application and classpath resources such as images, CSS and JavaScript files from well-known locations. -->
    <faces:resources />
    
    <!-- Maps request paths to flows in the flowRegistry; e.g. a path of /hotels/booking looks for a flow with id "hotels/booking" -->
    <bean class="org.springframework.webflow.mvc.servlet.FlowHandlerMapping">
        <property name="order" value="1"/>
        <property name="flowRegistry" ref="flowRegistry" />
        <property name="defaultHandler">
            <!-- If no flow match, map path to a view to render; e.g. the "/intro" path would map to the view named "intro" --> 
            <bean class="org.springframework.web.servlet.mvc.UrlFilenameViewController" />
        </property>
    </bean>
    
    
    
    
    
    
    <!-- Deploys a flow executor. A FlowExecutor executes flow definitions and acts as the entry-point into the 
         Web Flow system. A flow executor launches new flow executions and resumes paused flow 
         executions. Paused flow executions are stored between requests in a FlowExecutionRepository. -->
    <!-- Executes flows: the central entry point into the Spring Web Flow system -->
    <webflow:flow-executor id="flowExecutor">
        <webflow:flow-execution-listeners>
            <webflow:listener ref="facesContextListener" />
        </webflow:flow-execution-listeners>
    </webflow:flow-executor>
    
    <!-- Deploys a registry of flow definitions. A flow registry is used by a flow executor to locate flows to execute. 
         Each flow definition registered in this registry is assigned a unique identifier. By default, this identifier is 
         the name of the externalized resource minus its file extension. For example, a registry containing flow 
         definitions built from the files "orderitem-flow.xml" and "shipping-flow.xml" would index those 
         definitions by "orderitem-flow" and "shipping-flow" by default. -->
    <!-- The registry of executable flow definitions -->
    <webflow:flow-registry id="flowRegistry" flow-builder-services="flowBuilderServices" base-path="/WEB-INF/flows">
        <webflow:flow-location-pattern value="/**/*-flow.xml" />
    </webflow:flow-registry>
    
    <!-- Registers custom implementations of services needed to build flow definitions in a JSF environment. 
         With this tag, you may configure a custom ConversionService, FormatterFactory, ExpressionParser, 
         and ViewFactoryCreator implementation. This tag is only needed when you wish to plugin custom 
         implementations. -->
    <!-- Configures the Spring Web Flow JSF integration -->
    <faces:flow-builder-services id="flowBuilderServices" development="true" />
    
    <!-- A listener maintain one FacesContext instance per Web Flow request. -->
    <bean id="facesContextListener" class="org.springframework.faces.webflow.FlowFacesContextLifecycleListener" />  
    
    <!-- This adapter initializes itself with a JsfAjaxHandler instead of the Spring-JavaSciprtAjaxHandler previously 
         used with Spring Faces components. -->
    <bean class="org.springframework.faces.webflow.JsfFlowHandlerAdapter">
        <property name="flowExecutor" ref="flowExecutor" />
    </bean>
    
    <!-- <bean id="defaultServletHttpRequestHandler" class="org.springframework.web.servlet.resource.DefaultServletHttpRequestHandler" />
    
    <bean id="simpleUrlHandlerMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="urlMap">
            <map>
                <entry key="/resources/**" value-ref="defaultServletHttpRequestHandler" />
            </map>
        </property>
    </bean>
    
    <bean class="org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter" /> -->
    
    <mvc:annotation-driven />
    
    <bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="cache" value="false" />
        <property name="viewClass" value="org.springframework.faces.mvc.JsfView" />
        <property name="prefix" value="/WEB-INF/" />
        <property name="suffix" value=".xhtml" />
    </bean>
    
</beans>